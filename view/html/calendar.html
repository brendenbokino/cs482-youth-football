<!DOCTYPE html>
<html lang="en-us">

    <head>
        <meta charset="utf-8">
        <meta name="keywords" content="football, youth league, sports">
        <title>Loyal Order of Youth League Athletes</title>
        <link href="./css/main.css" rel="stylesheet" type="text/css">
        <link href="./css/popup.css" rel="stylesheet" type="text/css">
    </head>

    <body>
        <header>
            <img src="./images/logo.png" href="index.html">
            <h1> Loyal Order of Youth League Athletes </h1>
            <div class="topnav">
                <a href="calendar.html">Calendar</a>
                <a href="team.html">Team</a>
                <a href="profile.html">Profile</a>
                <a href="login.html">Login</a>
                <a href="register.html">Register</a>
                <a href="photos.html">Photos</a>
                <a href="coach.html">Coach Account</a>
            </div>
        </header>

        <main>
            <div style="max-width: 1100px; margin: 20px auto; padding: 10px;">
                <h2>Season Schedule</h2>
                <div id="calendar"></div>

                <hr style="margin: 24px 0;">

                <h3>Add New Game</h3>
                <form method="POST" action="/gameCreate" style="margin-bottom: 20px;">
                    <label for="team1">Team 1</label><br>
                    <input type="text" id="team1" name="team1" required style="width: 100%; padding: 8px; margin: 6px 0;"><br>

                    <label for="team2">Team 2</label><br>
                    <input type="text" id="team2" name="team2" required style="width: 100%; padding: 8px; margin: 6px 0;"><br>

                    <label for="date">Date</label><br>
                    <input type="date" id="date" name="date" required style="width: 100%; padding: 8px; margin: 6px 0;"><br>

                    <label for="location">Location</label><br>
                    <input type="text" id="location" name="location" required style="width: 100%; padding: 8px; margin: 6px 0;"><br>

                    <button type="submit" style="padding: 10px 16px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">Create Game</button>
                </form>
            </div>
        </main>

        
        <link href='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.css' rel='stylesheet' />
       
        <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js'></script>
        <script>
            function showGameDetails(props) {
                alert(`${props.team1} vs ${props.team2} at ${props.location}`);
            }

            async function loadGames() {
                try {
                    const res = await fetch('/games');
                    const data = await res.json();
                    if (!Array.isArray(data)) return [];
                    return data
                        .filter(g => !!g.date)
                        .map(g => ({
                            title: `${g.team1} vs ${g.team2}`,
                            start: g.date,
                            extendedProps: { location: g.location, team1: g.team1, team2: g.team2 }
                        }));
                } catch (e) {
                    console.error('Failed to load games', e);
                    return [];
                }
            }

            document.addEventListener('DOMContentLoaded', async function() {
                const events = await loadGames();
                const el = document.getElementById('calendar');
                const cal = new FullCalendar.Calendar(el, {
                    initialView: 'dayGridMonth',
                    events: events,
                    eventClick: function(info) { 
                        showGameDetails(info.event.extendedProps); 
                    },
                    headerToolbar: { 
                        left: 'prev,next today', 
                        center: 'title', 
                        right: 'dayGridMonth,dayGridWeek' 
                    }
                });
                cal.render();
            });
        </script>
    

        <footer>
            <p>
                Loyal Order of Youth League Athletes
                <br>
                contact info
            </p>
        </footer>
    </body>
</html>

